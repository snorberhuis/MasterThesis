\chapter{Implementation and experiments}
The design of MultiChain in the previous chapter has been fully implemented.
In this chapter we test if MultiChain is correctly implemented according to the design
and we experiment the MultiChain in various scenarios.
MultiChain is experimented with to test if it can correctly create a chain tracking a download.
Next, MultiChain is experimented with tracking anonymous downloads.
Finally, MultiChain is experimented with in potential situations where a deadlock may occur
to test if it succesfully resolve these situations.
We first introduce a several aspects of our experimental setup.

\subsubsection{Graph visualization}
In this chapter multiple graphs are depicted.
The graphs are the MultiChain generated by an experiment.
The blocks are depicted as nodes and the previous hash pointers are edges in the graph.
These graphs are generated by reading every database of every node.
A graph exchange xml file is created and this is loaded into Gephi.
Gephi is a graph visualization tool.

The nodes have added colouring to indicate extra meaning.
This can be seen in Figure \ref{fig:graph-example}.
Green nodes are a first block in a MultiChain of a peer,
and as such have no inbound arrows.
Blue nodes are a sequential block between the same previous peers,
therefore they do not have two inbound arrows.
Red nodes are half-signed blocks,
and therefore only have one inbound and one outbound arrow.

\begin{figure}[!h]
	\centerline{\includegraphics[scale=0.6]{experimentation/example.png}}
	\caption{Example of coloring used in Figures with graphs.}
	\label{fig:graph-example}
\end{figure}

\subsubsection{Synthetic setup}
In this chapter we perform several synthetic experiments.
In these experiments we simulate downloads being run within Tribler using scenarios files.
These files are sometimes generated using a special script we implemented and can be over 20000 lines long.
Every second the download is simulated to have progressed with a preset speed.
This progress is reported to every peer and their MultiChainScheduler.
In the real world the progress is updated more frequently but in much smaller increments.
The MultiChainScheduler waits for a certain amount of data transferred before it schedules a block to be created.
So the interval introduced by the scenario files is realistic and does not influence the outcome of the experiments.
In subsection \ref{subsect:gumby} we explain more about the experiment environment.

\subsubsection{Connectability problem}

Some experiments were also run multiple times because Dispersy does not always connect to every peer.
At the start of the experiment the peers are forced to be introduced,
but this does not always succeed.
This is a problem in discoverability and has been experienced by previous work aswell~\cite{ruigrok-anonymous}.
The final version is chosen when Dispersy did connect all the peers.
We recommend that Dispersy is changed to allow a modified behaviour when experimenting
where the pool of candidates is not refreshed,
as explained in section \ref{sect:bartercast}

\input{experimentation/unittests.tex}

\section{Tracking download and upload amounts}
In this section we will experiment with MultiChain creating blocks and tracking download and upload amounts of peers.
We will first start with creating a simple block in an experiment.
The next experiment is to try to create a chain of blocks with simulating a download of 10MB
and a larger download of 10GB.
Downloads are done at different download speeds and an experiment was done to test MultiChain in this environment.

\input{experimentation/singlerequest/singlerequest.tex}
\input{experimentation/chain/chain-experiment.tex}
\input{experimentation/speeds/speeds-experiment.tex}

\section{Tracking anonymous data transfer}
In this section we will experiment with MultiChain tracking anonymous data transfer.
Anonymous data transfer is a more complicated environment,
where multiple peers work together to transfer data from the seeder to the downloader.
We experiment in a synthetic environment and in environment using real anonymous downloads between peers.

\input{experimentation/anonymous/anonymous-experiment.tex}
\input{experimentation/anonymous-integrated/anonymous-integrated-experiment.tex}

\input{experimentation/deadlock/deadlock.tex}

